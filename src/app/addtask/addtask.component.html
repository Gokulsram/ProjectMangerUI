<div class="container">
    <div class="row">
        <div class="col-md-6">
            <form [formGroup]="taskForm">
                <div class="form-group">
                    <label>Project</label><br>
                    <input type="text" class="form-control" disabled='true' formControlName="Project" [ngClass]="{'is-invalid': submitted && f.Project.errors}" />
                    <div *ngIf="submitted && f.Project.errors" class="invalid-feedback">
                        <div *ngIf="f.Project.errors.required">>> Project Name is required</div>
                    </div>
                    <button class="btn btn-primary" (click)="OpenProjectModal()" [disabled]="isEditMode" >Search</button>
                </div>
                <div class="form-group">
                    <label>Task:</label>
                    <input type="text" class="form-control" formControlName="TaskName" [ngClass]="{'is-invalid': submitted && f.TaskName.errors}" />
                    <div *ngIf="submitted && f.TaskName.errors" class="invalid-feedback">
                        <div *ngIf="f.TaskName.errors.required">>> Task Name is required</div>
                    </div>
                </div>
                <div class="form-group">
                    <input type="checkbox" formControlName="isParentTask" (click)="onParentTaskChange($event)">&nbsp;&nbsp;Parent
                    Task
                </div>
                <div class="form-group">
                    <label>Priority</label>
                    0 <input type="range" min="0" max="100" formControlName="Priority" (change)="onPriorityChange($event)">
                    {{priority}}
                </div>
                <div class="form-group">
                    <label>Parent Task</label><br>
                    <input type="text" class="form-control" formControlName="ParentTask" /><br>
                    <button class="btn btn-primary" (click)="OpenParentTaskModal()" [disabled]="isParentTaskEnable">Search</button>
                    <input type="hidden" formControlName="ParentTaskId">
                </div>
                <div>

                    Start Date <input type="text" class="form-control" #dp="bsDatepicker" bsDatepicker class="form-control add-file-text"
                        formControlName="StartDate"><br><br>
                    End Date <input type="text" class="form-control" #dp="bsDatepicker" bsDatepicker class="form-control add-file-text"
                        formControlName="EndDate" (ngModelChange)="compareTwoDates()">
                    <br><br>
                    <div *ngIf="isLesserEndDate" class="alert alert-danger">
                        End Date cant before start date
                    </div>
                </div>
                <br>
                <br>
                <div class="form-group">
                    <label>User</label><br>
                    <input type="text" class="form-control" formControlName="UserName" /><br>
                    <input type="hidden" formControlName="UserId">
                    <button class="btn btn-primary" (click)="openUserModal()" [disabled]="isParentTaskEnable">Search</button>
                </div>
                <br>
                <div class="form-group">
                    <button class="btn btn-primary" (click)="onSubmit()">{{buttonCaption}}</button>&nbsp;&nbsp;
                    <button class="btn btn-primary" (click)="Reset()">{{cancelButtonCaption}}</button>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="backdrop" [ngStyle]="{'display':display}"></div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Project Details</h4>
                <button type="button" class="close" aria-label="Close" (click)="closeProjectModal()"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body" *ngIf="projectCount>0">
                <div class="container">
                    Search by Project Id, Project Name
                    <hr />
                    <div>
                        <input [(ngModel)]="searchUserText" placeholder="Search.." class="form-control"><br>
                    </div>
                    <div style="width: 450px; height: 300px; overflow-y: scroll;">
                        <table class="table table-striped table-responsive-sm table-responsive-md mt-3">
                            <thead class="task-head-sec">
                                <tr>
                                    <th scope="col">Project ID</th>
                                    <th scope="col">Project Name</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody class="task-body-sec">
                                <tr *ngFor="let project of allProjects | grdFilter: searchUserText">
                                    <td>{{ project.ProjectId }}</td>
                                    <td>{{ project.ProjectName }}</td>
                                    <td><button type="button" class="btn btn-default" (click)="SelectProject(project.ProjectId,project.ProjectName)">Select</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngIf="projectCount==0" style="color: red; font-weight: bold">No Records Found</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" (click)="closeProjectModal()">Close</button>
            </div>
        </div>
    </div>
</div>


<div class="backdrop" [ngStyle]="{'display':ParentTaskDisplay}"></div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':ParentTaskDisplay}">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Parent Task Details</h4>
                <button type="button" class="close" aria-label="Close" (click)="closeParentTaskModal()"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body" *ngIf="parentCount>0">
                <div class="container">
                    Search by Parent Task Id, Parent Task Name
                    <hr />
                    <div>
                        <input [(ngModel)]="searchParentText" placeholder="Search.." class="form-control"><br>
                    </div>
                    <div style="width: 450px; height: 300px; overflow-y: scroll;">
                        <table class="table table-striped table-responsive-sm table-responsive-md mt-3">
                            <thead class="task-head-sec">
                                <tr>
                                    <th scope="col">Parent Task ID</th>
                                    <th scope="col">Parent Task Name</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody class="task-body-sec">
                                <tr *ngFor="let parent of parentTask | grdFilter: searchParentText">
                                    <td>{{ parent.ParentTaskId }}</td>
                                    <td>{{ parent.ParentTask }}</td>
                                    <td><button type="button" class="btn btn-default" (click)="SelectParentTask(parent.ParentTaskId,parent.ParentTask)">Select</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngIf="parentCount==0" style="color: red; font-weight: bold">No Records Found</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" (click)="closeParentTaskModal()">Close</button>
            </div>
        </div>
    </div>
</div>


<div class="backdrop" [ngStyle]="{'display':userDisplay}"></div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':userDisplay}">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">User Details</h4>
                <button type="button" class="close" aria-label="Close" (click)="closeUserModal()"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body" *ngIf="userCount>0">
                <div class="container">
                    Search by User ID,First Name, Last Name & Employee ID
                    <hr />
                    <div>
                        <input [(ngModel)]="searchUserText" placeholder="Search.." class="form-control"><br>
                    </div>
                    <div style="width: 450px; height: 300px; overflow-y: scroll;">
                        <table class="table table-striped table-responsive-sm table-responsive-md mt-3">
                            <thead class="task-head-sec">
                                <tr>
                                    <th scope="col">User ID</th>
                                    <th scope="col">First Name</th>
                                    <th scope="col">Last Name</th>
                                    <th scope="col">Employee Id</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody class="task-body-sec">
                                <tr *ngFor="let user of allUsers                 
                 | grdFilter: searchUserText                 
                 ">
                                    <td>{{ user.UserId }}</td>
                                    <td>{{ user.FirstName }}</td>
                                    <td>{{ user.LastName }}</td>
                                    <td>{{ user.EmployeeId }}</td>
                                    <td><button type="button" class="btn btn-default" (click)="SelectUser(user.UserId,user.FirstName,user.LastName)">Select</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngIf="userCount==0" style="color: red; font-weight: bold">No Records Found</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" (click)="closeUserModal()">Close</button>
            </div>
        </div>
    </div>
</div>