<div class="container">
  <div class="row">
    <div class="col-md-6">
      <form [formGroup]="projectForm">
        <div class="form-group">
          <label>Project:</label>
          <input type="text" class="form-control" formControlName="ProjectName" [ngClass]="{'is-invalid': submitted && f.ProjectName.errors}" />
          <div *ngIf="submitted && f.ProjectName.errors" class="invalid-feedback">
            <div *ngIf="f.ProjectName.errors.required">>> Project Name is required</div>
          </div>
        </div>
        <div>
          <input type="checkbox" formControlName="StartDateEndDateChecked" (click)="onCheckChange($event)">&nbsp;&nbsp;Set
          Start and
          End Date<br /><br />
          <input type="text" class="form-control" #dp="bsDatepicker" bsDatepicker class="form-control add-file-text"
            formControlName="StartDate"><br><br>
          <input type="text" class="form-control" #dp="bsDatepicker" bsDatepicker class="form-control add-file-text"
            formControlName="EndDate" (ngModelChange)="compareTwoDates()">

          <br><br>
          <div *ngIf="isLesserEndDate" class="alert alert-danger">
            End Date cant before start date
          </div>
        </div>
        <br>
        <div class="form-group">
          <label>Priority</label>
          0 <input type="range" min="0" max="100" formControlName="Priority" (change)="onPriorityChange($event)">
          {{priority}}
        </div>
        <br>
        <div class="form-group">
          <label>Manager</label><br>
          <input type="text" class="form-control" [(ngModel)]="managerName" [ngModelOptions]="{standalone: true}"
            disabled /><br>
          <input type="hidden" formControlName="UserId">
          <button class="btn btn-primary" (click)="openModalDialog()">Search</button>
        </div>
        <br>
        <div class="form-group">
          <button class="btn btn-primary" (click)="onSubmit()">{{buttonCaption}}</button>&nbsp;&nbsp;
          <button class="btn btn-primary" (click)="Reset()">Reset</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="container" *ngIf="projectCount>0">
  <hr />
  <div>
    <input [(ngModel)]="searchText" placeholder="Search.." class="form-control"><br>
    Sort By: <button class="btn btn-primary" (click)="SortByProject('startdate')">Start Date</button> &nbsp;&nbsp;
    <button class="btn btn-primary" (click)="SortByProject('enddate')">End Date</button>&nbsp;&nbsp;
    <button class="btn btn-primary" (click)="SortByProject('priority')">Priority</button>&nbsp;&nbsp;
    <button class="btn btn-primary" (click)="SortByProject('completed')">Completed</button>&nbsp;&nbsp;
  </div>
  <br>
</div>
<div class="container">

  <ul class="list-group" *ngFor="let user of allProjects | grdFilter: searchText">
    <li class="list-group-item">
      <div> Project:
        <span class="badge">{{user.ProjectName}} </span>
      </div>
      <div> Start Date: <span class="badge">{{user.StartDate}} </span></div>
      <div> End Date: <span class="badge">{{user.EndDate}}</span> </div>
      <div> No of Tasks: <span class="badge" *ngIf="user.TasksCount>0">{{user.TasksCount}}</span> </div>
      <div> Completed: <span class="badge" *ngIf="user.CompletedTask>0">{{user.CompletedTask}}</span> <button class="btn btn-primary"
          (click)="ProjectEdit(user)">Update</button></div>
      <div> Priority: <span class="badge">{{user.Priority}}</span> <button class="btn btn-primary" (click)="DeleteProject(user.ProjectId)">Suspend</button></div>
    </li>
  </ul>
</div>

<div *ngIf="projectCount==0" style="color: red; font-weight: bold">No Records Found</div>

<div class="backdrop" [ngStyle]="{'display':display}"></div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">User Details</h4>
        <button type="button" class="close" aria-label="Close" (click)="closeModalDialog()"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" *ngIf="userCount>0">
        <div class="container">
          Search by User ID,First Name, Last Name & Employee ID
          <hr />
          <div>
            <input [(ngModel)]="searchUserText" placeholder="Search.." class="form-control"><br>
          </div>
          <div style="width: 450px; height: 300px; overflow-y: scroll;">
            <table class="table table-striped table-responsive-sm table-responsive-md mt-3">
              <thead class="task-head-sec">
                <tr>
                  <th scope="col">User ID</th>
                  <th scope="col">First Name</th>
                  <th scope="col">Last Name</th>
                  <th scope="col">Employee Id</th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody class="task-body-sec">
                <tr *ngFor="let user of allUsers                 
                 | paginate: { itemsPerPage: 5, currentPage: p } 
                 | grdFilter: searchUserText                 
                 ">
                  <td>{{ user.UserId }}</td>
                  <td>{{ user.FirstName }}</td>
                  <td>{{ user.LastName }}</td>
                  <td>{{ user.EmployeeId }}</td>
                  <td><button type="button" class="btn btn-default" (click)="SelectUser(user.UserId,user.FirstName,user.LastName)">Select</button></td>
                </tr>
              </tbody>
            </table>
            <pagination-controls (pageChange)="paging = $event" autoHide="true" responsive="true" previousLabel="Previous"
              nextLabel="Next" screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
              screenReaderCurrentLabel="You're on page" class="my-pagination"></pagination-controls>
          </div>
        </div>
      </div>
      <div *ngIf="userCount==0" style="color: red; font-weight: bold">No Records Found</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="closeModalDialog()">Close</button>
      </div>
    </div>
  </div>
</div>